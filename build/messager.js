window.Messager=function(){"use strict";var prefix="[PROJECT_NAME]",supportPostMessage="postMessage"in window;function Messager(e,t,i){if(!i){i="*"}this.listenFunc=[];this.target=t;this.origin=i;prefix=e||prefix;if(typeof prefix!=="string"){prefix=prefix.toString()}this.init()}Messager.prototype.init=function(){var self=this;var callback=function(msg){if(typeof msg=="object"&&msg.data){msg=msg.data}if(prefix!=msg.substring(0,prefix.length)){return}msg=msg.slice(prefix.length);msg=eval("("+msg+")");for(var i=0;i<self.listenFunc.length;i++){self.listenFunc[i](msg)}};if(supportPostMessage){if("addEventListener"in document){window.addEventListener("message",callback,false)}else if("attachEvent"in document){window.attachEvent("onmessage",callback)}}else{window.navigator[prefix+this.name]=callback}};Messager.prototype.post=function(e){if(typeof e=="object"){var t=function(e){var i=[];var s=function(e){if(typeof e=="object"&&e!=null)return t(e);return/^(string|number)$/.test(typeof e)?"'"+e+"'":e};for(var n in e)i.push("'"+n+"':"+s(e[n]));return"{"+i.join(",")+"}"};e=t(e)}else{throw"\u8bf7\u4f20\u8f93json\u6570\u636e"}if(supportPostMessage){this.target.postMessage(prefix+e,this.origin)}else{var i=window.navigator[prefix+this.name];if(typeof i=="function"){i(prefix+e,window)}}};Messager.prototype.listen=function(e){this.listenFunc.push(e)};return Messager}();